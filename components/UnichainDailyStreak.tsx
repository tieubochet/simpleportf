import React from 'react';
import { useUnichainStreak } from '../hooks/useUnichainStreak';

export const UnichainDailyStreak: React.FC = () => {
    const {
        isConnected,
        isConnecting,
        isInteracting,
        streak,
        error,
        connectWallet,
        checkInWithContract,
    } = useUnichainStreak();

    const iconButtonStyles = "flex items-center justify-center h-9 w-9 rounded-full transition-colors duration-300 relative disabled:opacity-70 disabled:cursor-not-allowed bg-pink-100 dark:bg-pink-900/50 hover:bg-pink-200 dark:hover:bg-pink-800/60";
    
    const buttonContent = (
        <>
            <svg className="h-5 w-5" viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="128" cy="128" r="128" fill="#FF007A"/>
                <path d="M178.66 133.5C178.22 133.5 177.78 133.28 177.56 132.84L171.02 120.42C170.8 119.98 171.02 119.32 171.46 119.1C171.9 118.88 172.56 119.1 172.78 119.54L179.32 131.96C179.54 132.4 179.32 133.06 178.88 133.28C178.88 133.5 178.66 133.5 178.66 133.5Z" fill="white"/>
                <path d="M193.32 111.98C193.32 111.98 193.32 111.98 193.1 111.98C192.66 111.98 192.22 111.54 192.22 111.1L192.22 101.98C192.22 101.54 192.66 101.1 193.1 101.1C193.54 101.1 193.98 101.54 193.98 101.98L193.98 111.1C193.98 111.54 193.54 111.98 193.1 111.98Z" fill="white"/>
                <path d="M186.22 121.76C185.78 121.76 185.34 121.54 185.12 121.1L179.98 111.76C179.76 111.32 179.98 110.66 180.42 110.44C180.86 110.22 181.52 110.44 181.74 110.88L186.88 120.22C187.1 120.66 186.88 121.32 186.44 121.54C186.44 121.76 186.22 121.76 186.22 121.76Z" fill="white"/>
                <path d="M129.56 205.26C129.56 205.26 129.34 205.26 129.12 205.04C120.44 197.94 112.42 189.92 105.54 181.24C105.1 180.58 105.32 179.7 105.98 179.26C106.64 178.82 107.52 179.04 107.96 179.7C114.62 188.16 122.2 195.74 130.44 202.4C130.88 202.84 131.1 203.5 130.88 204.16C130.66 204.82 130.22 205.26 129.56 205.26Z" fill="white"/>
                <path d="M138.88 64.02L101.54 94.82C100.88 95.26 100.44 96.14 100.66 97.02C101.1 99.44 99.32 101.54 97.02 101.76C96.14 101.76 95.26 102.42 94.82 103.3L86 124.64C82.88 132.88 82.66 142.42 85.34 150.88C87.78 158.88 93.1 165.54 100.22 169.54C102.88 171.1 105.76 172.22 108.66 172.88C109.1 172.88 109.54 172.66 109.76 172.22C110 171.78 109.76 171.34 109.32 171.1C106.64 170.44 104 169.32 101.54 168C94.88 164.22 90 158.22 87.78 150.88C85.34 143.08 85.56 134.2 88.44 126.4L97.26 105.06C97.48 104.62 97.92 104.4 98.36 104.4C98.58 104.4 98.8 104.4 99.02 104.62C99.46 104.84 99.68 105.5 99.46 105.94L94.16 116.66C93.72 117.54 94.16 118.64 95.04 119.08C95.92 119.52 97.02 119.08 97.46 118.2L103.18 106.64C104.28 104.64 103.84 102.2 102.2 100.66C100.66 99.12 98.36 98.44 96.36 99.02C95.48 99.24 94.38 98.8 93.94 97.92C93.72 97.26 93.94 96.6 94.38 96.16L131.72 65.36C132.16 64.92 132.82 64.92 133.26 65.36L137.92 70.02C138.36 70.46 138.36 71.12 137.92 71.56L129.56 79.92C129.12 80.36 128.46 80.36 128.02 79.92C127.58 79.48 127.58 78.82 128.02 78.38L136.38 70.02L132.16 65.8L138.44 64.46L138.88 64.02Z" fill="white"/>
                <path d="M179.32 139.7C172.88 141.7 165.78 143.5 158.44 144.82C157.78 145.04 157.12 144.6 156.9 143.94C156.68 143.28 157.12 142.62 157.78 142.4C165.12 141.08 171.9 139.3 178.22 137.48C178.88 137.26 179.54 137.7 179.76 138.36C179.98 138.8 179.76 139.48 179.32 139.7Z" fill="white"/>
                <path d="M153.56 120.64C153.34 120.64 153.12 120.64 152.88 120.42C140.22 112.42 126.22 106.64 111.32 103.3C110.66 103.08 110.22 102.42 110.44 101.76C110.66 101.1 111.32 100.66 111.98 100.88C127.32 104.22 141.76 110.22 154.88 118.44C155.54 118.88 155.76 119.76 155.32 120.42C154.88 120.64 154.44 120.64 153.98 120.64L153.56 120.64Z" fill="white"/>
                <path d="M149.78 172.64C149.34 172.64 148.88 172.42 148.66 171.98C143.34 162.44 136.88 153.76 129.56 146.44C128.9 145.78 128.9 144.68 129.56 144.02C130.22 143.36 131.32 143.36 131.98 144.02C139.52 151.56 146.2 160.46 151.52 170.22C151.96 171.1 151.52 172.2 150.64 172.64C150.42 172.64 150.2 172.64 149.78 172.64Z" fill="white"/>
                <path d="M129.56 89.54C122.66 90.64 118.44 97.46 119.54 104.4C120.64 111.3 127.56 115.52 134.46 114.4C141.36 113.3 145.58 106.48 144.48 99.54C143.38 92.64 136.46 88.42 129.56 89.54ZM133.36 111.76C127.78 112.64 122.2 109.1 121.32 103.52C120.44 97.94 123.98 92.46 129.56 91.58C135.14 90.7 140.72 94.16 141.6 99.74C142.48 105.32 138.94 110.88 133.36 111.76Z" fill="white"/>
            </svg>
            {isConnected && streak > 0 && (
                 <span className="absolute -top-0.5 -right-0.5 bg-pink-500 text-white text-[10px] font-bold min-w-[16px] h-4 px-1 flex items-center justify-center rounded-full ring-2 ring-pink-100 dark:ring-pink-900/50">
                    {streak}
                </span>
            )}
        </>
    );
    
    const handleClick = isConnected ? checkInWithContract : connectWallet;
    const isLoading = isInteracting || isConnecting;

    let title = isConnected 
        ? `Daily Streak (Unichain): ${streak}. Click to check in.` 
        : "Connect Unichain wallet for daily streak";
    if (isConnecting) title = "Connecting to Unichain...";
    if (isInteracting) title = "Submitting check-in on Unichain...";
    if (error) title = `Unichain Streak Error: ${error}`;

    return (
        <button onClick={handleClick} disabled={isLoading} className={iconButtonStyles} title={title} aria-label={title}>
            {buttonContent}
        </button>
    );
};
